# Analisi della profittabilità per l'attività di market making su Uniswap

Una delle piattaforme di punta per la cosiddetta DeFi (Decentralized Finance, chiamata anche Open Finance), Uniswap, ha introdotto un nuovo modello per regolare lo scambio di ETH e gli altri tokens ERC-20 che si differenzia dai modelli standard utilizzati nei mercati decentralizzati (DEXs, Decentralized Exchanges). Come è già stato elegantemente spiegato da Cyrus Younessi [https://medium.com/scalar-capital/uniswap-a-unique-exchange-f4ef44f807bf], Uniswap è unico in quanto esso agisce in modo più simile ad un mediatore che ad una piattaforma di trading. Gli utenti che vogliono investire in un token ERC-20 possono semplicemente scambiare ("swap") i loro ETH per ogni tokens ERC-20 e viceversa, il tutto con un unico click. Questa esperienza così dinamica ed immediata è possibile grazie ad un interfaccia [https://uniswap.exchange/swap] particolarmente semplice ed intuitiva. In aggiunta a queste caratteristiche uniche c'è anche il fatto che, nonostante Uniswap sia un progetto molto popolare, gli investitori non hanno l'effettiva possibilità di investire in questo protocollo.

[img_twitterUniswap]

Uniswap si distingue dai tradizionali modelli di business DeFi in vari modi; una differenza fra Uniswap e gli altri protocolli DeFi come Maker e Augur è la totale assenza di un token proprietario. Oltre a ciò, le commissioni ottenute dalle operazioni che avvengono sulla piattaforma non vengono percepite dalla società. Per tali ragioni, non c'è una modalità ovvia per investire, ad esempio tramite l'immissione di capitale nella società oppure attraverso l'acquisto dei token del progetto. I cosiddetti "tokenless DeFi protocols", come UniSwap o Dharma, sono unici in quanto il valore creato tramite il loro utilizzo viene distribuito fra gli utilizzatori della piattaforma e fra i servizi creati "on-top" (utilizzando, quindi, tali protocolli), invece che remunerare le società o i team che li hanno progettati.
Il modello utilizzato da Uniswap gli ha permesso di crescere stabilmente da dicembre dello scorso anno, come viene evidenziato anche dalla crescita dei volumi di scambio e della liquidità (cioè la quantità di ETH e tokens "contenuti" negli smart contracts).

[img_VolumeLiquidityCharts]

## Market Making su Uniswap
Per ottenere il valore generato dalla piattaforma UniSwap, un utente deve "partecipare" al protocollo fornendo liquidità all'exchange; tale attività, in finanza, è identificata con il nome di Market Making. Per definizione, tale attività consiste nel fornire liquidità per entrambe le parti (bid e ask) dell'orderbook dell'exchange, in modo tale da permettere ai traders di comprare o vendere nella piattaforma. Nei mercati tradizionali, il profitto ottenuto dai market markers (MMs) proviene dallo spread fra il bid e l'ask, cioè dalla differenza fra il prezzo a cui è possibile vendere e quello a cui è possibile acquistare un determinato asset. Tale attività è solitamente redditizia per chi la effettua, ma incorpora una componente di rischio durante fasi direzionali di mercato, ad esempio quando il prezzo di un asset aumenta o diminuisce in un breve periodo.

In UniSwap, il processo di market making è automatizzato. Un utente deve semplicemente immettere una certa quantità di denaro nella riserva di liquidità dell'exchange e lo smart contract di UniSwap effettuerà tale processo automaticamente. Il capitale dev'essere immesso in entrambi i lati dell'orderbook; in questo modo, se un MM vuole immettere $100 nel mercato ETH-DAI, metà del capitale verrà immesso in DAI e l'altra metà verrà immessa in ETH, al prezzo di mercato attuale. Il capitale immesso viene quindi aggiunto alle riserve di liquidità di UniSwap, in modo tale da aumentare la quantità di ETH e di DAI su cui è possibile effettuare operazioni di investimento (è possibile monitorare tali riserve qui [https://uniswap.info/]). Attualmente, le riserve presenti hanno XXX ETH e XXX DAI, per un valore totale di circa $XX MM.

In cambio del capitale immesso, il market maker (MM) riceve dei "liquidity tokens" [https://etherscan.io/token/0x09cabec1ead1c0ba254b09efb3ee13841712be14] che rappresentano la loro fetta di partecipazione a queste liquidity pool. L'interfaccia utente fornita dal team di UniSwap permette di visualizzare chiaramente il bilancio di liquidity tokens che un MM può ottenere; per esempio, la seguente figura mostra che un MM riceverà circa 0.29 liquidity tokens per aver immesso $100 di liquidità, i quali rappresentano una partecipazione dello 0.007% per la liquidity pool del mercato ETH-DAI. Quando un trader utilizza UniSwap per eseguire un'operazione fra ETH e DAI verrà applicata una commissione dello 0.3%, che verrà a sua volta aggiunta alla liquidity pool. Di conseguenza, in quanto tali commissioni vengono immesse nella liquidità disponibile al mercato, i liquidity tokens del MM aumenteranno proporzionalmente il loro valore, sia in ETH che in DAI. In questo caso, contrariamente a ciò che succede nelle piattaforme convenzionali, **le commissioni per il trading non vanno alla piattaforma stessa o al team di UniSwap, ma invece vengono distribuite fra gli utenti che forniscono liquidità ai mercati e che quindi ne permettono il loro funzionamento.** Un utente può riscattare, in ogni momento, tutti o una parte dei suoi liquidity tokens prelevando la liquidità messa a disposizione e riscattando la corrispondente partecipazione alla liquidity pool.

[img_UniSwapMM]

## Profittabilità del Market Making in UniSwap
Ottenere un profitto tramite il market making su UniSwap può sembrare un'attività lucrativa e permette, inoltre, di sostenere uno dei principi su cui si basa il movimento DeFi, cioè la disintermediazione UniSwap permette agli individui e agli investitori retail di elevarsi allo stesso livello delle istituzioni finaziare che effettuano market making nei mercati tradizionali e ottengono un profitto da tale servizio. Un ulteriore caratteristica positiva sta nel fatto che questo "business" viene effettuato su una piattaforma decentralizzata, dove i fondi degli utenti sono al sicuro dalla confisca/censura e chi offre tale servizio può rimanere anonimo.

Anche se, in termini generali, l'attività di market making su UniSwap è un interessante opportunità di investimento per gli investitori retail, sono presenti dei risvolti negativi. Il market making, in generale, è un'attività complessa che incorpora il rischio di perdere del denaro nel caso in cui si verifichi un forte movimento direzionale del prezzo dell'asset in questione; tale rischio è presente anche per il protocollo "Automated Market Making" (AMM) di UniSwap: tale metodo, conosciuto anche con il nome di "Constant Product Maker Maker" [https://github.com/runtimeverification/verified-smart-contracts/blob/uniswap/uniswap/x-y-k.pdf], permette di mantenere costante il prodotto fra gli ETH e i DAI presenti nel mercato. Il prezzo di ETH/DAI viene determinato come il rapporto fra la dimensione della riserva di ETH e della riserva di DAI presenti nello smart contract. Per esempio, se un contratto ha 130,000 DAI e 1000 ETH, il prezzo di ETH sarà 130 DAI; anche se il prezzo di mercato di ETH aumenta fino a $150, lo smart contract di UniSwap continuerà a mantenere tale prezzo. Gli arbitraggisti potranno così riallineare i prezzi comprando ETH utilizzando DAI (diminuendo così la riserva di ETH ed aumentando conseguentemente quella di DAI). In questo processo, gli arbitraggisti devono pagare la commissione, citata precedentemente, dello 0.3% e il gas utilizzato per la validazione della transazione nel network Ethereum. Questa opportunità di arbitraggio è ciò che attrae volume su UniSwap; **la domanda, però, è se l'attività dei MMs è effettivamente profittevole.**

Questa domanda è già stata trattata in vari articoli [https://medium.com/@pintail/understanding-uniswap-returns-cc593f3499ef], in cui è stato discusso come la profittabilità del market making sia influenzata dal cambiamento del prezzo, senza però considerare l'effetto delle commissioni accumulate durante tali operazioni. Per calcolare la percentuale di P/L, includendo anche le commissioni per l'esecuzione delle operazioni, è necessario utilizzare un modello numerico. [https://github.com/MFFouda/Research/blob/master/Uniswap_analysis.m]
Utilizzando tale modello, è stato possibile stimare quale sia la profittabilità del market making su UniSwap, utilizzando un prezzo iniziale per ETH di $130. L'analisi assume che un MM stia fornendo $100 di liquidità (50% in ETH e 50% in DAI) e calcola il profitto come la differenza fra il valore in dollari dei liquidity tokens posseduti dal MM dopo un determinato intervallo di tempo e il valore in dollari iniziale del tasso di cambio ETH/DAI, prima dell'inizio dell'attività di market making. Per calcolare ciò, il modello:
1. Stima la dimensione delle riserve di ETH e DAI dopo uno spostamento nel prezzo utilizzando la formula fornita dal protocollo AMM di UniSwap
2. Stima le commissioni che vengono immesse nelle riserve dopo i vari scambi effettuati, le quali corrispondono semplicemente allo 0.3% del volume scambiato; il modello assume un volume di scambio uniforme per tutto l'intervallo di tempo il cui il prezzo varia
3. Calcola la proporzione del MM di liquidity pool di ETH/DAI, basata sul rapporto fra i suoi liquidity tokens e il numero totale di liquidity tokens presenti in questo mercato; per semplicità, si assume che la dimensione della liquidity pool non cambia, aggiungendo o rimuovendo liquidità, durante la variazione del prezzo

[img_P/L]

La prima osservazione che si può fare è che un incremento o una diminuzione nel prezzo di ETH ha essenzialmente lo stesso effetto; ad esempio, un incremento o una diminuzione del 20% nel prezzo di ETH porterà ad un profitto del 2%, nel caso in cui il volume scambiato sia $8MM (milioni). Questo porta ad possibile seconda osservazione: lo scenario più profittevole è quando il prezzo dell'asset (in questo caso ETH) rimane uguale al prezzo al quale il MM ha fornito la liquidità. Quando avviene un significativo movimento del prezzo, l'attività di market making può generare una perdita per il MM.
Infine, come ultima osservazione, si può affermare che alti volumi di trading comportano maggiori commissioni e conseguentemente anche ad un aumento della profittabilità per le operazioni di market making.

[img_priceChange]

Per portare un esempio concreto, è possibile utilizzare i dati presenti sulla blockchain [https://etherscan.io/token/0x09cabec1ead1c0ba254b09efb3ee13841712be14] per tracciare l'attività di un indirizzo ETH casuale che ha fornito liquidità ad UniSwap per quanto riguarda la liquidity pool di ETH/DAI e calcolare il profitto ottenuto da questo indirizzo. Per esempio, il 14 febbraio, un MM ha immesso liquidità (immettendo 1 ETH e 123 DAI), ricevendo così in cambio 0.763 liquidity tokens. [https://etherscan.io/tx/0xebcdb78711ff6fabc63753cc3610ec1944cd65b13c6705b88796d94eb9f5ee84]
Il 4 marzo, dopo più di due settimane e un volume di scambio di circa %5.2MM, i liquidity tokens avevano un valore di 0.99 ETH e 128 DAI, per un valore totale di circa $256. Senza il market making, l'utente avrebbe avuto 123 DAI e 1 ETH, per un valore totale di circa $251. Se l'utente avesse deciso di ritirare la liquidità fornita, avrebbe realizzato un profitto di circa 2% in due settimane. In quanto il prezzo finale di ETH, per questo esempio, è molto vicino al prezzo iniziale (nel momento in cui è stata immessa la liquidità), la percentuale di profitto realizzato rappresenta lo scenario migliore.

[img_ETHDAI_LiquidityVolume]

E' possibile per i MMs applicare altre sofisticate strategie come l'aumento o la diminuzione graduale della liquidità fornita proporzionalmente ai movimenti del prezzo, in modo tale da realizzare un profitto maggiore; questo è possibile in quanto lo smart contract di UniSwap permette ai MMs di aggiungere o prelevare la liquidità in ogni momento. Molte società e fondi di investimento hanno così la possibilità di utilizzare tali strategie per realizzare un profitto addizionale nella loro attività di asset management, ma ne possono beneficiare anche tutti gli individui che hanno delle sostanziali riserve di ETH non utilizzati. La giusta infrastruttura potrebbe infatti permettere a tali attori di ottenere un reddito passivo interfacciandosi direttamente con gli smart contracts, senza l'utilizzo di intermediari.

In conclusione, i protocolli DeFi come UniSwap porteranno un'ondata d'innovazione nelle metodologie utilizzate per la gestione dei capitali finanziari. Tuttavia, dev'essere chiaro che, anjche se tali protocolli offrono per la prima volta l'opportunità agli investitori retail di effettuare operazioni prima solamente riservate agli investitori istituzionali, queste attività presuppongono un certo grado di rischio. La capacità, quindi, di analizzare efficacemente l'attività di market making in modo tale da identificare i possibili rischi e conseguentemente modellare delle strategie per mitigarli, determinerà la profittabilità stessa e la capacità di massimizzare i profitti.